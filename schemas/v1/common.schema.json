{
    "$schema": "https://json-schema.org/draft/2020-12/schema",
    "$id": "https://ciacob.github.io/OpenScoreIR/schemas/v1/common.schema.json",
    "$defs": {
        "ScoreInfo": {
            "type": "object",
            "properties": {
                "title": {
                    "type": "string"
                },
                "subtitle": {
                    "type": "string"
                },
                "composer": {
                    "type": "string"
                }
            },
            "additionalProperties": true
        },
        "Uuid": {
            "type": "string",
            "format": "uuid"
        },
        "Uuids": {
            "type": "array",
            "items": {
                "$ref": "#/$defs/Uuid"
            },
            "minItems": 1,
            "uniqueItems": true
        },
        "MidiValue": {
            "type": "number",
            "minimum": 0,
            "maximum": 128
        },
        "FractionString": {
            "type": "string",
            "pattern": "^-?\\d+\\/([1-9]\\d*)$"
        },
        "Fraction": {
            "oneOf": [
                {
                    "$ref": "#/$defs/FractionString"
                },
                {
                    "type": "array",
                    "items": [
                        {
                            "type": "integer"
                        },
                        {
                            "type": "integer",
                            "minimum": 1
                        }
                    ],
                    "minItems": 2,
                    "maxItems": 2
                },
                {
                    "type": "object",
                    "properties": {
                        "num": {
                            "type": "integer"
                        },
                        "den": {
                            "type": "integer",
                            "minimum": 1
                        }
                    },
                    "required": [
                        "num",
                        "den"
                    ],
                    "additionalProperties": false
                }
            ]
        },
        "NoteInstance": {
            "type": "object",
            "properties": {
                "step": {
                    "type": "string",
                    "enum": [
                        "A",
                        "B",
                        "C",
                        "D",
                        "E",
                        "F",
                        "G"
                    ]
                },
                "alteration": {
                    "type": "number",
                    "minimum": -2,
                    "maximum": 2
                },
                "octave": {
                    "type": "number",
                    "minimum": -1,
                    "maximum": 10
                }
            },
            "required": [
                "step",
                "octave"
            ],
            "additionalProperties": false
        },
        "NoteSymbol": {
            "type": "object",
            "properties": {
                "type": {
                    "type": "string",
                    "enum": [
                        "whole",
                        "half",
                        "quarter",
                        "eight",
                        "sixteenth",
                        "thirty-second",
                        "sixty-fourth"
                    ]
                },
                "numDots": {
                    "type": "number",
                    "minimum": 0,
                    "maximum": 3
                }
            },
            "required": [
                "type"
            ],
            "additionalProperties": false
        },
        "MeasureInstance": {
            "type": "object",
            "required": [
                "duration"
            ],
            "properties": {
                "timeSignature": {
                    "type": "array",
                    "items": {
                        "type": "integer",
                        "minimum": 1
                    },
                    "minItems": 2,
                    "maxItems": 2
                },
                "duration": {
                    "$ref": "#/$defs/Fraction"
                },
                "barline": {
                    "type": "string",
                    "enum": [
                        "normal",
                        "suggested",
                        "none",
                        "section",
                        "final",
                        "final-variation"
                    ],
                    "default": "normal"
                },
                "number": {
                    "$comment": "For overriding the real number, e.g., for subsequent sections re-numbering.",
                    "type": "integer",
                    "minimum": 1
                },
                "measureKind": {
                    "enum": [
                        "regular",
                        "pickup",
                        "final"
                    ],
                    "default": "regular"
                },
                "printNumber": {
                    "type": "boolean",
                    "default": true
                },
                "attachments": {
                    "type": "array",
                    "items": {
                        "$ref": "#/$defs/AttachableInstance"
                    }
                }
            },
            "unevaluatedProperties": false
        },
        "PartDefinition": {
            "type": "object",
            "properties": {
                "partName": {
                    "type": "string"
                },
                "partAbbrev": {
                    "type": "string"
                },
                "staffType": {
                    "type": "string",
                    "enum": [
                        "normal",
                        "grand",
                        "organ"
                    ],
                    "default": "normal"
                },
                "staffNames": {
                    "type": "array",
                    "items": {
                        "type": "string"
                    },
                    "minItems": 1
                },
                "clefs": {
                    "$comment": "This version does not support TAB notation.",
                    "type": "array",
                    "items": {
                        "type": "string",
                        "enum": [
                            "G",
                            "F",
                            "C",
                            "P",
                            "percussion",
                            "perc",
                            "G8vb",
                            "F8vb",
                            "G8va",
                            "F8va",
                            "soprano",
                            "mezzo",
                            "alto",
                            "tenor",
                            "baritone",
                            "none"
                        ],
                        "minItems": 1
                    },
                    "default": [
                        "G"
                    ]
                },
                "twoLayersPerStaff": {
                    "type": "boolean",
                    "default": true
                },
                "patch": {
                    "$ref": "#/$defs/MidiValue",
                    "default": 1
                }
            },
            "required": [
                "partName"
            ]
        },
        "PartDefinitions": {
            "type": "object",
            "patternProperties": {
                "^[a-f0-9-]{36}$": {
                    "$ref": "#/$defs/PartDefinition"
                }
            }
        },
        "PartInstance": {
            "type": "object",
            "properties": {
                "type": {
                    "$ref": "#/$defs/Uuid",
                    "typeName": {
                        "type": "string"
                    }
                },
                "typeName": {
                    "type": "string"
                },
                "index": {
                    "type": "number",
                    "minimum": 1,
                    "default": 1
                },
                "layer": {
                    "type": "number",
                    "minimum": 1,
                    "default": 1
                }
            },
            "required": [
                "type"
            ]
        },
        "PartInstances": {
            "type": "object",
            "patternProperties": {
                "^[a-f0-9-]{36}$": {
                    "$ref": "#/$defs/PartInstance"
                }
            }
        },
        "PercussionComboDefinition": {
            "type": "object",
            "properties": {
                "name": {
                    "type": "string"
                },
                "shortcut": {
                    "type": "string"
                },
                "pitches": {
                    "type": "array",
                    "items": {
                        "$ref": "#/$defs/MidiValue"
                    },
                    "minItems": 1,
                    "uniqueItems": true
                },
                "notes": {
                    "type": "array",
                    "items": {
                        "$ref": "#/$defs/NoteInstance"
                    },
                    "minItems": 1,
                    "uniqueItems": true
                },
                "noteheads": {
                    "type": "object",
                    "properties": {
                        "quarter": {
                            "type": "string"
                        },
                        "half": {
                            "type": "string"
                        },
                        "whole": {
                            "type": "string"
                        }
                    },
                    "minProperties": 1,
                    "staffPosition": {
                        "type": "number",
                        "minimum": -10,
                        "maximum": 18
                    },
                    "hasUpStem": {
                        "type": "boolean"
                    }
                }
            },
            "required": [
                "name",
                "shortcut",
                "pitches",
                "staffPosition"
            ],
            "additionalProperties": false
        },
        "PercussionSetDefinition": {
            "type": "object",
            "properties": {
                "name": {
                    "type": "string"
                },
                "description": {
                    "type": "string"
                },
                "combos": {
                    "type": "array",
                    "items": {
                        "$ref": "#/$defs/PercussionComboDefinition"
                    },
                    "minItems": 1
                }
            },
            "required": [
                "name",
                "combos"
            ],
            "additionalProperties": false
        },
        "PercussionSetDefinitions": {
            "type": "object",
            "patternProperties": {
                "^[a-f0-9-]{36}$": {
                    "$ref": "#/$defs/PercussionSetDefinition"
                }
            }
        }
    }
}